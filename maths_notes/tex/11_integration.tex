\section{Integration}

\subsection{Definition of a Riemann integral}

\subsection{Fundamental Theorem of Calculus} \label{sec_calc_FTC}

\subsection{Integration by Substitution} \label{sec_calc_substitution}

Integration by substitution is effectively the chain rule
(\ref{sec_calc_chain}) in reverse. If we consider the function
\begin{equation*}
 f(x) = g(h(x)) \implies f'(x) = h'(x) g'(h(x))
\end{equation*}
then the integral
\begin{equation}
 \integ{h'(x) g'(h(x))}{x} = \integ{f'(x)}{x} = f(x) + C
\end{equation}

\subsubsection{Trig Substitution} \label{sec_calc_trig_substitution}

\subsection{Integration by Parts}

\begin{theorem}[Integration by parts]
 \begin{equation*}
  \integ{g'(x)h(x)}{x} = g(x)h(x) - \integ{g(x)h'(x)}{x} + C
 \end{equation*}
\end{theorem}
\begin{proof}
 We can derive this from the product rule.
 (\ref{sec_calc_product}).  Consider the function
 \begin{equation*}
  f(x) = g(x) h(x) \implies f'(x) = g'(x) h(x) + g(x) h'(x)
 \end{equation*}
 then, by integrating both sides, and applying the distributivity of
 integration over addition,
 \begin{alignat*} 2
  && \integ{f'(x)}{x} &= \integ{(g'(x)h(x) + g(x)h'(x))}{x} + C \\
  &\implies{}& f(x) &= \integ{g'(x)h(x)}{x} + \integ{g(x)h'(x)}{x} + C \\
  &\implies{}& f(x) &= \integ{g'(x)h(x)}{x} + \integ{g(x)h'(x)}{x} + C \\
  &\implies{}& g(x)h(x)
      &= \integ{g'(x)h(x)}{x} + \integ{g(x)h'(x)}{x} + C \\
  &\implies{}& \integ{g'(x)h(x)}{x}
      &= g(x)h(x) - \integ{g(x)h'(x)}{x} + C \qedhere \\
 \end{alignat*}
\end{proof}

\subsection{Common integrals}

Similarly to the derivatives section, there are a number of slightly differing
tables in this section, and a number of subsection providing working. The first,
Table \ref{tab_calc_int_funcs}, gives antiderivatives of forms of composed
functions.  These are mostly obtained by reversing table
\ref{tab_calc_functions_derivatives}, using FTC.

Table \ref{tab_calc_int_common} gives the antiderivatives of some specific
functions, sometimes using FTC, sometimes by other techniques.

Table \ref{tab_calc_int_uncommon} gives further antiderivatives of oddly
specific functions.

Table \ref{tab_calc_int_uncommon_def} goes even further, giving examples of
interesting integrals that are only of interest when evaluated over a definite
interval.

In each table, again, particularly important rows are denoted \(\note\).

\begin{longtable}{*4M c}
 \toprule
 \text{\boldmath\(f(x)\)}
     & \text{\boldmath\(\integ{f(x)}{x}\ (+ C)\)}
     & \text{\bfseries Alternatives/Notes} & \note & \bfseries Reference\\
 \midrule
 \endhead
 g'(x) & g(x) \\[1ex]
     g(x) + h(x) & \integ{g(x)}{x} + \integ{h(x)}{x} \\[2ex]
     a g(x) & a\integ{g(x)}{x} & \text{\(a\) is a constant} \\[2ex]
     g(ax + b) & \frac 1a \integ{g(ax + b)}{x}
     & \text{\(a, b\) are constant} \\[2ex]
 g'(h(x)) h'(x) & g(h(x)) \\[1ex]
     g'(x) h(x) & g(x) h(x) - \integ{g(x) h'(x)}{x} \\[2ex]
 \frac{g'(x)}{g(x)} & \ln \abs{g(x)} \\[3ex]
 \frac{g'(x)}{\sqrt{g(x)}} & 2\sqrt{g(x)} \\[3ex]
 \bottomrule
 \caption{Antiderivatives of general forms of functions}
 \label{tab_calc_int_funcs}
\end{longtable}

\begin{longtable}{*4M c}
 \toprule
 \text{\boldmath\(f(x)\)}
     & \text{\boldmath\(\integ{f(x)}{x}\ (+ C)\)}
     & \text{\bfseries Alternatives/Notes} & \note & \bfseries Reference\\
 \midrule
 \endhead
 x^n & \frac 1{n + 1}x^{n + 1} & n \ne -1 \\[3ex]
 \frac 1x & \ln \abs x \\[3ex]
 e^x & e^x & \text{\(e\) is Euler's constant} \\[1ex]
 a^x & \frac 1{\ln a}a^x & \text{\(a\) is a constant} \\[3ex]
 \sin x & -\cos x \\[1ex]
 \cos x & \sin x \\[1ex]
 \tan x & -\ln \abs{\cos x} & \ln \abs{\sec x} \\[1ex]
 \sec x & \ln \abs{\sec x + \tan x}
     & \ln \abs*{\tan{(\tfrac 12 x + \tfrac 14 \pi)}} \\[2ex]
 \csc x & \ln \abs{\csc x - \cot x} & \ln \abs*{\tan{(\tfrac 12 x)}} \\[2ex]
 \cot x & \ln \abs{\sin x} \\[1ex]
 \sin^2 x & \tfrac 12 x - \tfrac 14 \sin 2x \\[1ex]
 \cos^2 x & \tfrac 12 x + \tfrac 14 \sin 2x \\[1ex]
 \tan^2 x & \tan x - x \\[1ex]
 \sec^2 x & \tan x \\[1ex]
 \csc^2 x & -\cot x \\[1ex]
 \cot^2 x & -\cot x - x \\[1ex]
 \bottomrule
 \caption{Common antiderivatives}
 \label{tab_calc_int_common}
\end{longtable}

\begin{longtable}{*4M c}
 \toprule
 \text{\boldmath\(f(x)\)}
     & \text{\boldmath\(\integ{f(x)}{x}\ (+ C)\)}
     & \text{\bfseries Alternatives/Notes} & \note & \bfseries Reference\\
 \midrule
 \endhead
 \frac{\cos x}{\sin x + \cos x}
     & \tfrac 12 x + \tfrac 12 \ln \abs{\sin x + \cos x} \\[3ex]
 \frac{\sin x}{\sin x + \cos x}
     & \tfrac 12 x - \tfrac 12 \ln \abs{\sin x + \cos x} \\[3ex]
 \bottomrule
 \caption{Niche but interesting antiderivatives}
 \label{tab_calc_int_uncommon}
\end{longtable}

\begin{longtable}{*6M c}
 \toprule
 \text{\boldmath\(f(x)\)}
     & \text{\boldmath\(x_1\)} & \text{\boldmath\(x_2\)}
     & \text{\boldmath\(\integ[x_1]<x_2>{f(x)}{x}\)}
     & \text{\bfseries Notes} & \note & \bfseries Reference\\
 \midrule
 \endhead
 e^{-x^2} & -\infty & \infty & \sqrt \pi && \note \\[1ex]
 \frac{f(ax) - f(bx)} x & 0 & \infty & (f(\infty) - f(0)) \ln \frac ab
     & \text{\(a, b\) const.} && \ref{sec_calc_frullani} \\[3ex]
 \frac{f(x)}{f(x) + f(a + b - x)} & a & b & \frac{b - a} 2
     & \text{\(a, b\) const.} \\[3ex]
 \frac{f(x)}{x(f(x) + f(ab / x))} & a & b & \frac 12 \ln \frac ba
     & \text{\(a, b\) const.} \\[3ex]
 \bottomrule
 \caption{Very niche but interesting definite integrals}
 \label{tab_calc_int_uncommon_def}
\end{longtable}

\subsubsection{Frullani Integral} \label{sec_calc_frullani}

\begin{theorem}[Frullani's Integral]
 Where the limit of \(f(x)\) exists at both 0 and \(\infty\), and \(f'(x)\)
 exists and is continuous on \(\intoo{0, \infty}\),
 \begin{equation*}
  \integ[0]<\infty>{\frac{f(ax) - f(bx)} x}{x}
  = (f(\infty) - f(0))\ln \frac ab
 \end{equation*}
\end{theorem}
\begin{proof}
 This can be shown by using differentiation under the integral sign. We note
 that the integrand is itself the definite integral of \(f'(tx)\) with
 respect to \(t\), from \(b\) to \(a\). We can then exchange the integrals.
 %FIXME justify
 \begin{align*}
  \integ[0]<\infty>{\frac{f(ax) - f(bx)} x}{x} &=
  \integ[0]<\infty>{\integ[b]<a>{f'(tx)}{t}}{x} \\
  &= \integ[b]<a>{\integ[0]<\infty>{f'(tx)}{x}}{t} \\
  &= \integ[b]<a>{\frac{f(tx)}{t}\eval_{x=0}^\infty}{t} \\
  &= \integ[b]<a>{\frac 1t(f(\infty) - f(0))}{t} \\
  &= (f(\infty) - f(0))\integ[b]<a>{\frac 1t}{t} \\
  &= (f(\infty) - f(0))\ln \frac ab \qedhere
 \end{align*}
\end{proof}

\subsubsection[Archyperbolic \texorpdfstring{\(t\)}{t} substitutions]
              {Archyperbolic \boldmath\(t\)-substitutions}

\begin{theorem}[Archyperbolic t substitution]
 \begin{equation*}
  \integ{f(x + \sqrt{x^2 + 1})}{x}
  = \frac 12 \integ{\parens[\Big]{1 + \frac 1{t^2}}f(t)}{t}
 \end{equation*}
 where \(t = x + \sqrt{x^2 + 1}\).
 \begin{equation*}
  \integ{f(x + \sqrt{x^2 - 1})}{x}
  = \frac 12 \integ{\parens[\Big]{1 - \frac 1{t^2}}f(t)}{t}
 \end{equation*}
 where \(t = x + \sqrt{x^2 - 1}\).
\end{theorem}
\begin{proof}
 To find the integral of some function \(f(x + \sqrt{x^2 + 1})\), we can make
 the substitution \(t = x + \sqrt{x^2 + 1}\). Noting that
 \(t^{-1} = \sqrt{x^2 + 1} - x\), we have \(\frac 12(t - t^{-1}) = x\)
 and also \(\frac 12(t + t^{-1}) = \sqrt{x^2 + 1}\), so in fact the form of
 \(f\) can involve both \(x\) and \(\sqrt{x^2 + 1}\) as these can be
 written in terms of \(t\). From the former equation, we have also
 \begin{alignat*}{2}
  && \dv<x>{t} &= \frac 12\parens[\Big]{1 + \frac 1{t^2}} \\
  &\implies{}& \integ{f(x + \sqrt{x^2 + 1})}{x}
  &= \frac 12 \integ{\parens[\Big]{1 + \frac 1{t^2}}f(t)}{t}
 \end{alignat*}
 Similarly for the second one, we let \(t = x + \sqrt{x^2 - 1}\) so that
 \(t^{-1} = x - \sqrt{x^2 - 1}\), and we have \(\frac 12(t + t^{-1}) = x\)
 and also \(\frac 12(t - t^{-1}) = \sqrt{x^2 - 1}\). Therefore,
 \begin{alignat*}{2}
  && \dv<x>{t} &= \frac 12\parens[\Big]{1 - \frac 1{t^2}} \\
  &\implies{}& \integ{f(x + \sqrt{x^2 - 1})}{x}
  &= \frac 12 \integ{\parens[\Big]{1 - \frac 1{t^2}}f(t)}{t} \qedhere
 \end{alignat*}
\end{proof}

\subsubsection{Negated involution substitution}

\begin{theorem}[Additive involution substitution]
 \begin{equation*}
  \integ[a]<b>{\frac{f(x)}{f(x) + f(a + b - x)}}{x} = \frac{b - a} 2
 \end{equation*}
\end{theorem}
\begin{proof}
 Let \(I\) denote the integral, and make the substitution \(u = a + b - x\),
 \begin{alignat*}{2}
  &\implies{}& \dv<u>{x} &= -1, \quad x = a + b - u \\
  &\implies{}& I &= \integ[a + b - a]<a + b - b>{
                      \frac{-f(a + b - u)}{f(a + b - u) + f(u)}}{u} \\
  &&  &= \integ[a]<b>{\frac{f(a + b - u)}{f(a + b - u) + f(u)}}{u} \\
  &\implies{}& I + I &= \integ[a]<b>{
                      \frac{f(a + b - x) + f(x)}
                          {f(a + b - x) + f(x)}}{x} \\
  &&  &= \integ[a]<b>{1}{x} = b - a \\
  &\implies{}& I &= \frac{b - a} 2 \qedhere
 \end{alignat*}
\end{proof}
\begin{theorem}[Divisive involution substitution]
 \begin{equation*}
  \integ[a]<b>{\frac{f(x)}{x(f(x) + f(ab / x))}}{x} = \frac 12 \ln \frac ba
 \end{equation*}
\end{theorem}
\begin{proof}
 Again let \(I\) denote the integral. Make the substitution \(u = ab / x\),
 \begin{alignat*}{2}
  &\implies{}& \dv<u>{x} &= -\frac{ab}{x^2} = -\frac ux, \quad x = \frac{ab}u \\
  &\implies{}& I &= \integ[ab/a]<ab/b>{\frac{-f(ab / u)}{u(f(ab / u) + f(u))}
  }{u} \\
  && &= \integ[a]<b>{\frac{f(ab / u)}{u(f(ab / u) + f(u))}}{u} \\
  &\implies{}& I + I &= \integ[a]<b>{\frac{f(ab / x) + f(x)}
                                  {x(f(ab / x) + f(x))}}{x} \\
  && &= \integ[a]<b>{\frac 1x}{x} = \ln \frac ba \\
  &\implies{}& I &= \frac 12 \ln \frac ba \qedhere
 \end{alignat*}
\end{proof}

\subsubsection{Gaussian Integral}

\begin{theorem}[Gaussian Integral] \label{thm_gauss_integral}
 \begin{equation*}
  \integ[-\infty]<\infty>{e^{-x^2}}{x} = \sqrt \pi
 \end{equation*}
\end{theorem}
\begin{proof}
 We can consider first the square of the integral.
 \begin{align*}
  \parens[\Big]{\integ[-\infty]<\infty>{e^{-x^2}}{x}}^2
  &= \parens[\Big]{\integ[-\infty]<\infty>{e^{-x^2}}{x}}
     \parens[\Big]{\integ[-\infty]<\infty>{e^{-y^2}}{y}} \\
  &= \integ[-\infty]<\infty>{
                 \parens[\Big]{\integ[-\infty]<\infty>{e^{-y^2}}{y}}
             e^{-x^2}}{x} \\
  &= \integ[-\infty]<\infty>{
         \parens[\Big]{\integ[-\infty]<\infty>{e^{-y^2} e^{-x^2}}{y}}}{x} \\
  &= \integ[-\infty]<\infty>{
         \integ[-\infty]<\infty>{e^{-x^2-y^2}}{y}}{x}
 \end{align*}
 %FIXME diagram of this
 This is effectively integrating some function of \((x, y)\) over
 \(\Reals^2\), giving the volume between an infinite solid and the \((x, y)\)
 plane. By noting that the function only depends on the distance of
 \((x, y)\) from \((0, 0)\) (ie \(x^2 + y^2\)), we see that this volume is
 equivalent to the volume obtained by fully rotating the curve in the
 \(y = e^{-x^2}\) where
 \(x \in \intco{0, \infty} \implies y \in \intoc{0, 1}\) around the y axis.
 This means
 \begin{alignat*}{2}
  && \parens[\Big]{\integ[-\infty]<\infty>{e^{-x^2}}{x}}^2
      &= \integ[0]<1>{\pi x^2}{y} \\
  &&  &= -\pi \integ[0]<1>{\ln y}{y} \\
  &&  &= -\pi (y\ln y - y)\eval_0^1 \\
  &&  &= -\pi (0 - 1 - 0 + 0) \\
  &&  &= \pi \\
  &\implies{}& \integ[-\infty]<\infty>{e^{-x^2}}{x}
      &= \sqrt \pi \qedhere
 \end{alignat*}
\end{proof}
This proof is a bit of a ``trick''. The standard way to approach an integral
like this is by contour integration or something.

This integral is used as the normalising constant of the normal
distribution. It also pops up in the evaluation of \(\Gamma(\frac 12)\).

It's a quite famous example of an integral of an elementary integrand that
has no elementary antiderivative, but when taken as a definite integral can
be solved analytically.

\subsection{Volume of Revolution}

\subsection{Area under Parametric Curve} \label{sec_calc_parametric_area}

To find the area between a curve and the \(x\)-axis from \(x_1\) to \(x_2\)
when the curve is given in parametric form, \((x, y) = (f(t), g(t))\),
we rewrite the integral, effectively using a substitution
(\ref{sec_calc_substitution}) \(x = f(t)\) in order to express the integrand
in \(t\).
\begin{equation}
 \integ[x_1]<x_2>{y}{x} =
 \integ[t_1]<t_2>{y \dv<x>{t}}{t} =
 \integ[t_1]<t_2>{g(t)f'(t)}{t}
\end{equation}
where \(f(t_1) = x_1\) and \(f(t_2) = x_2\).

Similarly, the area between the curve and the y-axis from \(y_1\) to \(y_2\)
is:
\begin{equation}
 \integ[y_1]<y_2>{x}{y} =
 \integ[t_1]<t_2>{x \dv<y>{t}}{t} =
 \integ[t_1]<t_2>{f(t)g'(t)}{t}
\end{equation}
where \(g(t_1) = y_1\) and \(g(t_2) = y_2\).

\subsection{Arc Length}

\subsection{Improper Integrals}

%FIXME add types of improper integral
